# Define your Tenable.io API credentials
$accessKey  = "{accessKey}"
$secretKey = "{secretKey}"

# Define the Tenable.io API endpoint for listing scans
$apiUrl = "https://cloud.tenable.com/scans"

#define apikey
$headers = @{
    "X-ApiKeys" = "accessKey=$accessKey;secretKey=$secretKey"
    "Content-Type" = "application/json"
}

# Make the API request to list all scans
$response = Invoke-RestMethod -Uri $apiUrl -Method Get -Headers $headers


if ($response) {
    #Iterate and paste each scan id and name
    $scans = $response.scans | ForEach-Object {
        [PSCustomObject]@{
            ScanId = $_.id
            Name   = $_.name
        }
    }
    $scans | Format-Table -AutoSize
} else {
    Write-Output "No scan"
}
